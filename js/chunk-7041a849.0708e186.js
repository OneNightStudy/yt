(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7041a849","chunk-2d0b90a5","chunk-2d22d9c9"],{"28a5":function(e,t,i){i("214f")("split",2,function(e,t,a){"use strict";var s=i("aae3"),r=a,n=[].push,c="split",l="length",o="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[l]||2!="ab"[c](/(?:ab)*/)[l]||4!="."[c](/(.?)(.?)/)[l]||"."[c](/()()/)[l]>1||""[c](/.?/)[l]){var u=void 0===/()??/.exec("")[1];a=function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!s(e))return r.call(i,e,t);var a,c,d,p,h,m=[],b=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),k=0,f=void 0===t?4294967295:t>>>0,g=new RegExp(e.source,b+"g");u||(a=new RegExp("^"+g.source+"$(?!\\s)",b));while(c=g.exec(i)){if(d=c.index+c[0][l],d>k&&(m.push(i.slice(k,c.index)),!u&&c[l]>1&&c[0].replace(a,function(){for(h=1;h<arguments[l]-2;h++)void 0===arguments[h]&&(c[h]=void 0)}),c[l]>1&&c.index<i[l]&&n.apply(m,c.slice(1)),p=c[0][l],k=d,m[l]>=f))break;g[o]===c.index&&g[o]++}return k===i[l]?!p&&g.test("")||m.push(""):m.push(i.slice(k)),m[l]>f?m.slice(0,f):m}}else"0"[c](void 0,0)[l]&&(a=function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)});return[function(i,s){var r=e(this),n=void 0==i?void 0:i[t];return void 0!==n?n.call(i,r,s):a.call(String(r),i,s)},a]})},"30f8":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v(e._s(e.$t("search")))]),i("Button",{on:{click:e.handleReset}},[e._v(e._s(e.$t("reset")))])],1)},s=[],r={name:"search-button",props:{params:{type:Object,required:!0}},methods:{handleSearch:function(){this.params.pageNumber=1,this.params.pageSize=10,this.$emit("getList")},handleReset:function(){this.$emit("reset"),this.params.pageNumber=1,this.params.pageSize=10,this.$emit("getList")}}},n=r,c=i("2877"),l=Object(c["a"])(n,a,s,!1,null,null,null);l.options.__file="search-button.vue";t["default"]=l.exports},7195:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"backupScheduler"},[i("Row",[i("Col",[i("Card",[i("Row",[i("Form",{ref:"backupSchedulerForm",attrs:{model:e.backupSchedulerForm,inline:"","label-width":60}},[i("FormItem",{attrs:{label:e.$t("backupScheduler.city"),prop:"cityId"}},[i("Select",{staticClass:"select-width",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("backupScheduler.cityTip"),clearable:""},on:{"on-change":e.changeDistrict},model:{value:e.backupSchedulerForm.cityId,callback:function(t){e.$set(e.backupSchedulerForm,"cityId",t)},expression:"backupSchedulerForm.cityId"}},e._l(e.cityList,function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),i("FormItem",{attrs:{label:e.$t("backupScheduler.district"),prop:"districtId"}},[i("Select",{staticClass:"select-width",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("backupScheduler.districtTip"),clearable:""},model:{value:e.backupSchedulerForm.districtId,callback:function(t){e.$set(e.backupSchedulerForm,"districtId",t)},expression:"backupSchedulerForm.districtId"}},e._l(e.districtList,function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),i("FormItem",{attrs:{label:e.$t("name"),prop:"name"}},[i("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:e.$t("backupScheduler.nameTip")},model:{value:e.backupSchedulerForm.name,callback:function(t){e.$set(e.backupSchedulerForm,"name",t)},expression:"backupSchedulerForm.name"}})],1),i("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[i("search-button",{attrs:{params:e.backupSchedulerForm},on:{reset:e.reset,getList:e.getBackupSchedulerList}})],1)],1)],1),i("table-grid",{attrs:{loading:e.loading,columns:e.columns,data:e.data,total:e.total,tableAdd:e.tableAdd,tableDelAll:e.tableDelAll,params:e.backupSchedulerForm,exportFromId:e.exportFromId},on:{getList:e.getBackupSchedulerList}})],1)],1)],1),i("Modal",{attrs:{title:e.modalTitle,width:300},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[i("span",[e._v(e._s(e.$t("selectTimeTip"))+":  ")]),i("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:e.$t("selectTimeTip")},on:{"on-change":function(t){e.delayTime=t}},model:{value:e.delayTime,callback:function(t){e.delayTime=t},expression:"delayTime"}}),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),i("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submit}},[e._v(e._s(e.$t("submit")))])],1)],1)],1)},s=[],r=(i("28a5"),i("7f7f"),i("f7df")),n=i("30f8"),c=i("365c"),l=i("a78e"),o=i.n(l),u={name:"backup-scheduler",components:{"table-grid":r["default"],"search-button":n["default"]},data:function(){var e=this;return{backupSchedulerForm:{name:"",areaId:"",cityId:"",districtId:"",pageNumber:1,pageSize:10,sort:"updateTime",order:"desc"},loading:!1,total:0,data:[],cityList:[],districtList:[],columns:[{type:"index",width:60,align:"center"},{title:this.$t("name"),key:"name",width:150,align:"center",sortable:!0,render:function(e,t){var i=t.row,a=i.failTaskTime,s=i.name;return a?(s+="("+a+")",e("span",{style:{color:"red"}},s)):e("span",s)}},{title:this.$t("backupScheduler.status"),key:"status",width:70,align:"center",render:function(t,i){var a="";switch(i.row.status){case"NORMAL":return a=e.$t("backupScheduler.normal"),t("span",{style:{color:"green"}},a);case"PAUSED":return a=e.$t("backupScheduler.paused"),t("span",{style:{color:"red"}},a);case"COMPLETE":return a=e.$t("backupScheduler.complete"),t("span",a);case"ERROR":return a=e.$t("backupScheduler.error"),t("span",{style:{color:"red"}},a);case"BLOCKED":return a=e.$t("backupScheduler.blocked"),t("span",{style:{color:"#FF7F24"}},a);default:return t("span",a)}}},{title:this.$t("backupScheduler.simpleExpression"),key:"cronZh",align:"center",width:185},{title:this.$t("backupScheduler.nextFireTime"),key:"nextFireTime",width:155,align:"center",sortable:!0},{title:this.$t("backupScheduler.prevFireTime"),key:"prevFireTime",width:155,align:"center",sortable:!0},{title:this.$t("backupScheduler.prevResult"),key:"prevResult",width:150,align:"center",render:function(t,i){var a=e,s=i.row.prevResult.split(":"),r=a.$t("backupScheduler.succNum")+" "+s[0],n=a.$t("backupScheduler.failedNum")+" "+s[1];return 0<s[1]?t("div",[t("span",{style:{marginRight:"5px"}},r),t("span",{attrs:{title:e.$t("backupScheduler.viewLog")},style:{color:"red",cursor:"pointer"},on:{click:function(){e.viewNeLog(i.row)}}},n)]):t("div",[t("span",{style:{marginRight:"5px"}},r),t("span",n)])}},{title:this.$t("updateTime"),key:"updateTime",width:155,align:"center",sortable:!0,sortType:"desc"},{title:this.$t("operation"),key:"action",align:"center",fixed:"right",width:160,render:function(t,i){return t("div",[t("Icon",{props:{type:"md-document",size:"20",color:"#6CA6CD"},attrs:{title:e.$t("backupScheduler.viewLog")},style:{marginRight:"10px",cursor:"pointer"},on:{click:function(){e.viewLog(i.row)}}}),t("Icon",{props:{type:"md-power",size:"20",color:"#71C671"},attrs:{title:e.$t("backupScheduler.runTask")},style:{marginRight:"10px",cursor:"pointer",display:"PAUSED"===i.row.status&&"BLOCKED"!==i.row.status?"inline-block":"none"},on:{click:function(){e.runTask(i.row)}}}),t("Icon",{props:{type:"md-pause",size:"20",color:"#CD3333"},attrs:{title:e.$t("backupScheduler.stopTask")},style:{marginRight:"10px",cursor:"pointer",display:"NORMAL"===i.row.status&&"BLOCKED"!==i.row.status?"inline-block":"none"},on:{click:function(){e.stopTask(i.row)}}}),t("Icon",{props:{type:"md-radio-button-on",size:"20",color:"#191970"},attrs:{title:e.$t("backupScheduler.runOnceTask")},style:{marginRight:"10px",cursor:"pointer",display:"BLOCKED"!==i.row.status?"inline-block":"none"},on:{click:function(){e.runOnceTask(i.row)}}}),t("Icon",{props:{type:"md-water",size:"20",color:"#9400D3"},attrs:{title:e.$t("backupScheduler.runOnceFailedTask")},style:{marginRight:"10px",cursor:"pointer",display:"BLOCKED"!==i.row.status?"inline-block":"none"},on:{click:function(){e.runOnceFailedTask(i.row)}}})])}}],tableAdd:!1,tableDelAll:!1,exportFromId:"",modalTitle:"",modalVisible:!1,submitLoading:!1,delayTime:"",scheId:""}},methods:{init:function(){this.getBackupSchedulerList(),this.getCityList()},getCityList:function(){var e=this;Object(c["X"])(this.backupSchedulerForm.areaId).then(function(t){0===t.code&&(e.cityList=t.content)})},changeDistrict:function(e){var t=this;void 0!==e&&Object(c["db"])(e,this.backupSchedulerForm.areaId).then(function(e){0===e.code&&(t.backupSchedulerForm.districtId="",t.districtList=[],t.districtList=e.content)})},getBackupSchedulerList:function(){var e=this;for(var t in this.loading=!0,this.backupSchedulerForm)null!==this.backupSchedulerForm[t]&&void 0!==this.backupSchedulerForm[t]||(this.backupSchedulerForm[t]="");Object(c["R"])(this.backupSchedulerForm).then(function(t){e.loading=!1,0===t.code&&(e.data=t.content.content,e.total=t.content.totalElements)})},reset:function(){this.$refs.backupSchedulerForm.resetFields()},viewLog:function(e){this.$store.commit("setLogName",e.name),this.$router.push({name:"backup-log"})},viewNeLog:function(e){var t={jobLogId:"",name:""};t.jobLogId=e.jobLogId,t.name=e.name,this.$store.commit("setConnectionLogDetail",t),this.$store.commit("setConnectionLogDetailFlag","schedulerDirect"),this.$router.push({name:"connection-log-detail"})},runTask:function(e){var t=!0,i=new Date(e.nextFireTime).getTime(),a=(new Date).getTime();a>i&&(t=!1),this.optTask(e.id,"launchTask",t)},stopTask:function(e){this.optTask(e.id,"pauseTask",!1)},runOnceTask:function(e){this.optTask(e.id,"runOnceTask",!1)},runOnceFailedTask:function(e){var t=this,i={schedulerId:e.id};this.$Modal.confirm({title:this.$t("pleaseConfirm"),content:this.$t("backupScheduler.runDelayTip"),onOk:function(){t.delayTime="",t.modalType=0,t.modalTitle=t.$t("selectTimeTip"),t.scheId=e.id,t.modalVisible=!0},onCancel:function(){var e=t.$t("backupScheduler.runTip");setTimeout(function(){t.optTaskConfirm(i,"runOnceFailTask",e)},500)}})},optTask:function(e,t,i){var a={schedulerId:e},s=this.$t("backupScheduler.runTip");"pauseTask"===t?s=this.$t("backupScheduler.stopTip"):"runOnceTask"===t||"runOnceFailTask"==t?s=this.$t("backupScheduler.runOnceOrfailTip"):a.isRunExpTime=i,this.optTaskConfirm(a,t,s)},optTaskConfirm:function(e,t,i){var a=this;this.$Modal.confirm({title:this.$t("pleaseConfirm"),content:i,onOk:function(){var i="/backup/web/backup/scheduler/"+t;Object(c["xb"])(i,e).then(function(e){0===e.code&&(a.$Message.success(a.$t("operationSuccess")),a.getBackupSchedulerList())})}})},cancel:function(){this.modalVisible=!1},submit:function(){var e=this;if(""!==this.delayTime){this.submitLoading=!0;var t="/backup/web/backup/scheduler/runOnceFailTaskDelay",i={schedulerId:this.scheId,excuteDate:this.delayTime};Object(c["xb"])(t,i).then(function(t){e.submitLoading=!1,0===t.code&&(e.$Message.success(e.$t("operationSuccess")),e.modalVisible=!1)})}else this.$Message.warning(this.$t("selectTimeTip"))}},mounted:function(){var e=JSON.parse(o.a.get("userInfo"));this.backupSchedulerForm.areaId=e.address,this.init()}},d=u,p=i("2877"),h=Object(p["a"])(d,a,s,!1,null,null,null);h.options.__file="backupScheduler.vue";t["default"]=h.exports},f7df:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Row",{staticClass:"br",staticStyle:{"margin-bottom":"2vh"}},[this.tableAdd?i("span",[i("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v(e._s(e.$t("add")))])],1):e._e(),this.tableDelAll?i("span",[i("Button",{attrs:{type:"error",icon:"md-trash"},on:{click:e.delAll}},[e._v(e._s(e.$t("batchDelete")))])],1):e._e(),this.tableRefresh?i("span",[i("Button",{attrs:{type:"success",icon:"md-refresh"},on:{click:e.refresh}},[e._v(e._s(e.$t("refresh")))])],1):e._e(),""!==this.exportFromId?i("span",[i("export-button",{attrs:{exportParams:e.params,exportUrl:e.exportUrl,exportFromId:e.exportFromId}})],1):e._e()]),i("Row",[this.tableDelAll?i("span",[i("Alert",{attrs:{"show-icon":""}},[e._v("\n                "+e._s(e.$t("hasSelected"))+" "),i("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" "+e._s(e.$t("items"))+"\n                "),i("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v(e._s(e.$t("clear")))])])],1):e._e()]),i("Row",[i("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.showSelect,"on-row-dblclick":e.dblclick}})],1),i("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[i("Page",{attrs:{current:e.pageNumber,total:e.total,"page-size":e.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)},s=[],r=(i("ac6a"),i("f3e2"),i("c5f6"),i("365c")),n=i("3eac"),c={name:"table-grid",components:{"export-button":n["default"]},data:function(){return{pageNumber:1,pageSize:10,selectCount:0,selectList:[]}},props:{loading:{type:Boolean,required:!0},columns:{type:Array,required:!0},data:{type:Array,required:!0},total:{type:Number,required:!0},delAllUrl:{type:String,default:""},params:{type:Object,required:!0},exportUrl:{type:String,default:""},exportFromId:{type:String,default:""},tableAdd:{type:Boolean,default:!0},tableDelAll:{type:Boolean,default:!0},tableRefresh:{type:Boolean,default:!0}},methods:{add:function(){this.$emit("add")},delAll:function(){var e=this;""!==this.delAllUrl?this.selectCount<=0?this.$Message.warning(this.$t("deleteTip")):this.$Modal.confirm({title:this.$t("confirmDelete"),content:this.$t("deleteContent1")+this.selectCount+this.$t("deleteContent2")+"？",onOk:function(){var t="";e.selectList.forEach(function(e){t+=e.id+","}),t=t.substring(0,t.length-1);var i={ids:t};Object(r["p"])(e.delAllUrl,i).then(function(t){0===t.code&&(e.$Message.success(e.$t("deleteSuccess")),e.clearSelectAll(),e.$emit("getList"))})}}):this.$Message.warning(this.$t("deleteInvalidTip"))},refresh:function(){this.$emit("getList")},clearSelectAll:function(){this.$refs.table.selectAll(!1)},changeSort:function(e){this.params.sort=e.key,this.params.order=e.order,"normal"===e.order&&(this.params.order=""),this.$emit("getList")},showSelect:function(e){this.selectList=e,this.selectCount=e.length},changePage:function(e){this.params.pageNumber=e,this.$emit("getList"),this.clearSelectAll()},changePageSize:function(e){this.params.pageSize=e,this.$emit("getList")},dblclick:function(e,t,i){this.$emit("dblclick",e)}}},l=c,o=i("2877"),u=Object(o["a"])(l,a,s,!1,null,null,null);u.options.__file="table-grid.vue";t["default"]=u.exports}}]);