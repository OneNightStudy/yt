(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11c47fb7"],{1971:function(t,e,o){"use strict";o("6c7b"),o("57e7"),o("f751"),o("a481"),o("28a5");var i=o("8465"),l=o("752d"),a=o("24f9"),r={canvasExtend:function(){Object(i["a"])()},initBg:function(t,e,o){var i=document.createElement("canvas");i.width=t,i.height=e;var l=i.getContext("2d");return o&&(l.fillStyle=o),l.fillRect(0,0,i.width,i.height),l.save(),i},_toNum:function(t){return null!==t&&""!==t?parseInt(t.split("px")[0],10):void 0},_analyseLabel:function(t){var e=t.tagName,o=t.offsetLeft,i=t.offsetTop,r=null;if("TD"===e){var n=t.querySelector("div"),s=l["a"].getRealStyle(n);o+=n.offsetLeft-this._toNum(s.marginLeft),i+=n.offsetTop-this._toNum(s.marginTop),r=s.transform}else r=t.style.transform;var h=l["a"].getRealStyle(t),d=this._toNum(h.lineHeight),c=h.fontSize;return{isMemo:!!a["a"].hasClass(t,"memo_text")||void 0,font:"14px "+h.fontFamily,fontFamily:h.fontFamily,fontSize:this._toNum(c.split("px")[0]),text:t.innerText,color:h.color,width:t.offsetWidth,height:t.offsetHeight,transform:r,lineHeight:d,offsetLeft:o,offsetTop:i,lineNum:Math.ceil(t.offsetHeight/d)}},_analyseIcon:function(t){var e=l["a"].getRealStyle(t),o=e.backgroundImage,i={offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight};return o&&"none"!==o?(o=o.replace(/"/g,"").split("url(")[1],i.backgroundImage=o.substr(0,o.length-1),o=e.backgroundPosition.split(" "),i.pX=-1*parseFloat(o[0].split("px")[0]),i.pY=-1*parseFloat(o[1].split("px")[0]),i.offsetLeft=t.parentNode.offsetLeft,i.offsetTop=t.parentNode.offsetTop):Object.assign(i,{font:"18px "+e.fontFamily.split(" ")[0],lineHeight:this._toNum(e.lineHeight),color:e.color,opacity:parseFloat(e.opacity),content:window.getComputedStyle(t,"::before").getPropertyValue("content")}),i},_fillIcon:function(t,e,o,i,l,a){var r=t.getContext("2d");if(void 0===i.backgroundImage){0===i.content.indexOf('"')&&(i.content=i.content.split('"')[1]),i.color=i.color.replace("rgb","rgba").replace(")",", "+i.opacity+")"),r.fillStyle=i.color,r.font=i.font,r.textAlign="center",r.textBaseline="middle";var n=window.ActiveXObject||"ActiveXObject"in window?0:1,s=e+i.offsetLeft+4+i.width/2+n,h=o+i.offsetTop+2+i.height/2+n;return r.save(),r.translate(s,h),r.scale(a,a),r.fillText(i.content,0,0),r.restore(),null}r.save();var d=0,c=0;i.pX<0&&(d-=i.pX,i.pX=0),i.pY<0&&(c-=i.pY,i.pY=0);var f=i.isCustom?0:2*a;r.drawImage(l,i.pX,i.pY,i.width,i.height,e+i.offsetLeft+f+d,o+i.offsetTop+f+c,i.width*a,i.height*a),r.restore()},_fillLabel:function(t,e,o,i,l,a){var r=t.getContext("2d");r.fillStyle=i.color,r.textAlign="center",i.isMemo&&(r.textAlign="left"),r.font=i.font,r.textBaseline="top";var n=i.text,s=0,h=0,d=window.ActiveXObject||"ActiveXObject"in window?1:3,c=e+i.offsetLeft+(i.isMemo?0:i.width/2)+d/2,f=o+i.offsetTop+d;a&&(c-=a.x,f+=a.y),navigator.userAgent.indexOf("Firefox")>=0&&(f+=i.lineHeight-i.fontSize),r.save(),r.translate(c,f),f=0,c=0,r.scale(l,l);for(var p=0;p<n.length;p++)s+=r.measureText(n[p]).width,p!==n.length-1?s>=i.width/l&&(r.fillText(n.substring(h,p),c,f),f+=i.lineHeight,s=0,h=p):r.fillText(n.substring(h,p+1),c,f);r.restore()},_analyseArea:function(t){var e=t.querySelector(".bg"),o=l["a"].getRealStyle(e);return{top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,borderColor:o.borderTopColor,bgColor:o.backgroundColor,opacity:parseFloat(o.opacity),icon:this._analyseIcon(t.querySelector("i")),label:this._analyseLabel(t.querySelector("label"))}},renderAreas:function(t,e,o,i){var l=t.getContext("2d");for(var a in e){var r=e[a];r.bgColor=r.bgColor.replace("rgb","rgba").replace(")",", "+r.opacity+")"),r.borderColor=r.borderColor.replace("rgb","rgba").replace(")",", "+r.opacity+")"),l.fillStyle=r.bgColor,l.strokeStyle=r.borderColor,l.rect(r.left,r.top,r.width,r.height),l.fill(),l.stroke(),this._fillIcon(t,r.left-3,r.top-3,r.icon,o,i),this._fillLabel(t,r.left,r.top,r.label,i)}},_analyseMemo:function(t){var e=this._analyseIcon(t.querySelector("i"));e.font="14px "+e.font.split(" ")[1];var o=this._analyseLabel(t.querySelector(".memo_text"));o.font="12px "+o.fontFamily;var i=l["a"].getRealStyle(t);return{top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,bgColor:i.color,boxShadow:i.boxShadow,icon:e,label:o}},renderMemos:function(t,e,o){var i=t.getContext("2d");for(var l in e){var a=e[l];i.save(),i.fillStyle=a.bgColor;var r=a.boxShadow.split(") ");i.shadowColor=r[0],r=r[1].split(" "),i.shadowOffsetX=this._toNum(r[0]),i.shadowOffsetY=this._toNum(r[1]),i.shadowBlur=this._toNum(r[2]),i.beginPath(),i.moveTo(a.left+10,a.top),i.lineTo(a.left+a.width,a.top),i.lineTo(a.left+a.width,a.top+a.height),i.lineTo(a.left,a.top+a.height),i.lineTo(a.left,a.top+10),i.lineTo(a.left+10,a.top),i.closePath(),i.fill(),i.restore(),i.save(),i.fillStyle="rgba(0,0,0,0.1)",i.beginPath(),i.moveTo(a.left+10,a.top),i.lineTo(a.left+10,a.top+10),i.lineTo(a.left,a.top+10),i.lineTo(a.left+10,a.top),i.closePath(),i.fill(),i.restore(),i.save(),i.fillStyle=a.icon.color,i.font=a.icon.font,i.textAlign="center",i.textBaseline="middle";var n=a.left+a.width/2,s=a.top+2;i.translate(n,s),i.scale(o,o),0===a.icon.content.indexOf('"')&&(a.icon.content=a.icon.content.split('"')[1]),i.fillText(a.icon.content,0,0),i.restore(),this._fillLabel(t,a.left,a.top,a.label,o)}},_analyseNode:function(t){var e="";a["a"].hasClass(t,"item_ellipse")&&(e="ellipse"),a["a"].hasClass(t,"item_rhomb")&&(e="rhomb"),a["a"].hasClass(t,"item_round")&&(e="round"),a["a"].hasClass(t,"item_parallelogram")&&(e="parallelogram"),a["a"].hasClass(t,"item_custom")&&(e="custom");var o=l["a"].getRealStyle(t),i={top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,borderColor:o.borderTopColor,borderWidth:this._toNum(o.borderTopWidth),bgColor:o.backgroundColor,borderRadius:this._toNum(o.borderTopLeftRadius),boxShadow:o.boxShadow,spClass:e,icon:this._analyseIcon(t.querySelector(".ico").childNodes[0])};return a["a"].hasClass(t,"item_round")||a["a"].hasClass(t,"item_rhomb")||a["a"].hasClass(t,"item_custom")?i.label=this._analyseLabel(t.querySelector(".span")):i.label=this._analyseLabel(t.querySelector("td").nextSibling),"custom"===e&&(i.icon.isCustom=!0),i},renderNodes:function(t,e,o,i){var l=t.getContext("2d");for(var a in e){var r=e[a],n=r.boxShadow.split(") ");if(1===n.length){var s=r.boxShadow.split("rgba");n[0]="rgba"+s[1],n[1]=s[0]}"custom"!==r.spClass&&(l.shadowColor=n[0],n=n[1].split(" "),l.shadowOffsetX=this._toNum(n[0])+(r.borderWidth>1?1:0),l.shadowOffsetY=this._toNum(n[1])+(r.borderWidth>1?1:0),l.shadowBlur=this._toNum(n[2])),l.fillStyle=r.bgColor,"ellipse"===r.spClass?l.BezierEllipse(r.left+r.width/2,r.top+r.height/2,r.width/2,r.height/2).fill():"rhomb"===r.spClass?(l.save(),l.translate(r.left+r.width/2,r.top+r.height/2),l.rotate(45*Math.PI/180),l.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),l.restore()):"parallelogram"===r.spClass?(l.save(),l.translate(r.left+r.width/2,r.top+r.height/2),l.transform(1,0,-12/r.height,1,0,0),l.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),l.restore()):"custom"===r.spClass||l.roundRect(r.left+r.borderWidth/2,r.top+r.borderWidth/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),l.shadowBlur=0,l.shadowColor="",l.shadowOffsetX=0,l.shadowOffsetY=0,l.strokeStyle=r.borderColor,l.lineWidth=0===r.borderWidth?.01:r.borderWidth,l.stroke(),this._fillIcon(t,r.left+(r.borderRadius>6?-3:0),r.top,r.icon,o,i),this._fillLabel(t,r.left,r.top,r.label,i,"rhomb"===r.spClass?{x:r.width/3*1.41,y:r.height/4}:void 0)}},_analyseLine:function(t,e){var o=l["a"].getRealStyle(t).fontFamily,i=e.querySelector("path[stroke-linecap]"),a=i.getAttribute("marker-end"),r={color:i.getAttribute("stroke"),lineWidth:i.getAttribute("stroke-width"),lineCap:"round",noArrow:!a||null==a},n=i.style.strokeDasharray;r.lineDash=n&&null!=n;var s=e.childNodes[2],h=s.getAttribute("fill");h&&null!==h&&""!==h||(h="#777"),r.label={text:s.textContent,font:s.style.fontSize+" "+o,color:h,left:s.getAttribute("x"),top:s.getAttribute("y")};for(var d=i.getAttribute("d"),c=d.substring(2,d.length).split(/[L|Q]/),f=[],p=0;p<c.length;++p){c[p]=c[p].replace(/^\s+|\s+$/gm,"");var u=c[p].split(" ");2===u.length?f.push({x:parseFloat(u[0]),y:parseFloat(u[1])}):f.push({x:parseFloat(u[0]),y:parseFloat(u[1]),dX:parseFloat(u[2]),dY:parseFloat(u[3])})}r.points=f;var g=f.length,m=f[g-1].x-f[g-2].x,b=f[g-1].y-f[g-2].y;return r.angle=Math.atan2(b,m),r},renderLines:function(t,e){var o=t.getContext("2d");for(var i in e){var l=e[i];o.save(),o.setLineDash(l.lineDash?[4,6]:[]),o.strokeStyle=l.color,o.lineWidth=l.lineWidth,o.lineCap=l.lineCap;var a=l.points;o.beginPath(),o.moveTo(a[0].x,a[0].y);for(var r=1;r<a.length;++r)if(a[r].dX){var n=a[r].y===a[r].dY?Math.abs(a[r].x-a[r].dX):Math.abs(a[r].y-a[r].dY);o.arcTo(a[r].x,a[r].y,a[r].dX,a[r].dY,n),o.moveTo(a[r].dX,a[r].dY)}else o.lineTo(a[r].x,a[r].y),r!==a.length-1&&o.moveTo(a[r].x,a[r].y);if(o.closePath(),o.stroke(),l.noArrow||(o.translate(a[a.length-1].x,a[a.length-1].y),o.rotate(l.angle),o.fillStyle=l.color,o.beginPath(),o.moveTo(1*l.lineWidth,0),o.lineTo(-6*l.lineWidth,-3*l.lineWidth),o.lineTo(-6*l.lineWidth,3*l.lineWidth),o.lineTo(1*l.lineWidth,0),o.closePath(),o.fill()),o.restore(),l.label&&null!=l.label.text&&""!=l.label.text){var s=t.getContext("2d"),h=l.label;s.fillStyle=h.color,s.textAlign="center",s.font=h.font,s.fillText(h.text,h.left,h.top)}}}};function n(t,e,o){try{var i=new Blob([t]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,e+"."+o);else{var l=document.createElement("a");l.href=window.URL.createObjectURL(i),l.download=e+"."+o,l.click(),window.URL.revokeObjectURL(l.href)}}catch(i){for(var a=window.open("","_blank");"complete"!==a.document.readyState&&"complete"!==a.document.readyState;);a.document.write("<html><head><title>"+e+"."+o+"</title></head><body><pre>"+("xml"===o?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t)+"</pre></body></html>")}}e["a"]={flag:"export",initFuncName:"canvasExtend",methods:{canvasExtend:function(){r.canvasExtend()},exportDiagram:function(t){for(var e=void 0,o=null,i={},l=this.$refs.$group.querySelectorAll(".GooFlow_area"),a=0;a<l.length;++a)i[l[a].id]=r._analyseArea(l[a]),i[l[a].id].icon.backgroundImage&&null===o&&(o=i[l[a].id].icon.backgroundImage);for(var n={},s=this.$refs.$paper.querySelectorAll(".GooFlow_memo"),h=0;h<s.length;++h)n[s[h].id]=r._analyseMemo(s[h]);for(var d={},c=this.$refs.$workArea.querySelectorAll(".GooFlow_item"),f=0;f<c.length;++f)d[c[f].id]=r._analyseNode(c[f]),d[c[f].id].icon.backgroundImage&&null===o&&(o=d[c[f].id].icon.backgroundImage);var p=this._suitSize(),u=p.width+100*this.scale,g=p.height+100*this.scale,m=r.initBg(u,g,"#ffffff"),b=this;null!==o&&((e=new Image).setAttribute("crossOrigin","anonymous"),e.src=o);var v=function(){l.length>0&&r.renderAreas(m,i,e,b.scale),s.length>0&&r.renderMemos(m,n,b.scale),r.renderNodes(m,d,e,b.scale);var o=m.getContext("2d");if(o.restore(),window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("Edge")>-1){for(var a={},h=this.$refs.$draw.querySelectorAll("g"),c=0;c<h.length;++c)"GooFlow_tmp_line"!==h[c].getAttribute("tid")&&(a[h[c].id]=r._analyseLine(b.$el,h[c]));r.renderLines(m,a);try{var f=m.msToBlob();navigator.msSaveBlob(f,t+".png")}catch(e){for(var p=m.toDataURL("image/png"),v=window.open("","_blank");"complete"!==v.document.readyState&&"complete"!==v.document.readyState;);v.document.write("<html><head><title>"+t+'.png</title></head><body><img src="'+p+'" border="1" title="'+t+'.png"></body></html>')}}else{var w='<svg xmlns="http://www.w3.org/2000/svg" width="'+u+'" height="'+g+'"><defs><style type="text/css">text{font-size:14px;line-height:1.42857143;font-family:"Microsoft Yahei", "Helvetica Neue", Helvetica, Hiragino Sans GB, WenQuanYi Micro Hei, Arial, sans-serif;}</style></defs>'+b.$refs.$draw.innerHTML+"</svg>",y=new Image;y.src="data:image/svg+xml,"+encodeURIComponent(w),y.onload=function(){o.drawImage(y,0,0);var e=document.createElementNS("http://www.w3.org/1999/xhtml","a");e.href=m.toDataURL("image/png"),e.download=t+".png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}};!e||e.complete||window.ActiveXObject||"ActiveXObject"in window?v():e.onload=function(){v()}},exportDataFile:function(t,e){if("json"===e)n(JSON.stringify(this.exportData()),t,"json");else{if("xml"!==e)return;try{n(this.exportBpmnXML(),t,"xml")}catch(t){console.warn("failed in exec function exportBpmnXML()! you need extend the xml.js plugin for supported.")}}}}}},"19bb":function(t,e,o){var i=o("1f39");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var l=o("499e").default;l("031257f8",i,!0,{sourceMap:!1,shadowMode:!1})},"1f39":function(t,e,o){e=t.exports=o("2350")(!1),e.i(o("2d1f"),""),e.push([t.i,"\n.GooFlow .ico_huber{background:url(/static/img/gooflow_icon.png) no-repeat -116px -45px\n}\n.GooFlow .ico_huber,.GooFlow .ico_router{opacity:1!important;filter:Alpha(Opacity=100)!important\n}\n.GooFlow .ico_router{background:url(/static/img/gooflow_icon.png) no-repeat -97px -45px\n}\n.GooFlow .custom_huber{background:url(/static/img/gooflow_icon.png) no-repeat -1px -84px\n}\n.GooFlow .custom_huber,.GooFlow .custom_router{opacity:1!important;filter:Alpha(Opacity=100)!important\n}\n.GooFlow .custom_router{background:url(/static/img/gooflow_icon.png) no-repeat -106px -83px\n}\n.GooFlow .ico_plug2{background:url(/static/img/gooflow_icon.png) no-repeat -135px -45px;opacity:1!important;filter:Alpha(Opacity=100)!important\n}",""])},2381:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"DemoCustom"}},[o("goo-flow",{ref:"gooFlow",attrs:{property:t.myProps,global:t.global,plugIns:t.plugIns}},[o("div",{staticStyle:{float:"right","margin-right":"15px"},attrs:{slot:"headerCustom"},slot:"headerCustom"},[t._v("自定义背景图节点 "),o("button",{attrs:{type:"button"},on:{click:function(e){t.exportDiagram()}}},[t._v("导出流程图片")])])])],1)},l=[],a=o("2380"),r=o("5410"),n=o("6ed2"),s=o("f673"),h=o("9fec"),d=o("645d"),c=o("1971"),f=o("bc3a"),p=o.n(f),u=o("70e5"),g={name:"DemoCustom",components:{GooFlow:a["a"]},data:function(){return{myProps:{id:"aaaabbb",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["huber","router","plug2","complex mix"],nodeCustoms:{huber:{class:"custom_huber",width:102,height:50},router:{class:"custom_router",width:115,height:52}},auth:u["a"]},global:r["a"],plugIns:[n["a"],s["a"],h["a"],d["a"],c["a"]]}},methods:{exportDiagram:function(){this.$refs.gooFlow.exportDiagram("myFlow")}},mounted:function(){var t=this.$refs.gooFlow;p.a.get("./static/demo/data3.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e)}),t.bindOperEvent({onPrintClick:function(){t.print()},onBtnSaveClick:function(){t.exportDiagram("myFlow")}})}},m=g,b=(o("8669"),o("2877")),v=Object(b["a"])(m,i,l,!1,null,null,null);v.options.__file="DemoCustom.vue";e["default"]=v.exports},"36bd":function(t,e,o){"use strict";var i=o("4bf8"),l=o("77f1"),a=o("9def");t.exports=function(t){var e=i(this),o=a(e.length),r=arguments.length,n=l(r>1?arguments[1]:void 0,o),s=r>2?arguments[2]:void 0,h=void 0===s?o:l(s,o);while(h>n)e[n++]=t;return e}},"6c7b":function(t,e,o){var i=o("5ca1");i(i.P,"Array",{fill:o("36bd")}),o("9c6c")("fill")},8465:function(t,e,o){"use strict";
/**
 * GooFlow-Vue - Web端流程设计器
 * @author foolegg126 (sdlddr)
 * @version v1.1.0
 * @license Commercially licensed to 宜通世纪科技股份有限公司-91440101731569620Y(自动运维系统)
 **/e["a"]=function(){CanvasRenderingContext2D.prototype.roundRect=function(t,e,o,i,l){return o<2*l&&(l=o/2),i<2*l&&(l=i/2),this.beginPath(),this.moveTo(t+l,e),this.arcTo(t+o,e,t+o,e+i,l),this.arcTo(t+o,e+i,t,e+i,l),this.arcTo(t,e+i,t,e,l),this.arcTo(t,e,t+o,e,l),this.closePath(),this},CanvasRenderingContext2D.prototype.BezierEllipse=function(t,e,o,i){var l=.5522848,a=o*l,r=i*l;return this.beginPath(),this.moveTo(t-o,e),this.bezierCurveTo(t-o,e-r,t-a,e-i,t,e-i),this.bezierCurveTo(t+a,e-i,t+o,e-r,t+o,e),this.bezierCurveTo(t+o,e+r,t+a,e+i,t,e+i),this.bezierCurveTo(t-a,e+i,t-o,e+r,t-o,e),this.closePath(),this}}},8669:function(t,e,o){"use strict";var i=o("19bb"),l=o.n(i);l.a}}]);