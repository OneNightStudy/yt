(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23fa1f25"],{3550:function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"\n.orderOp .name .ivu-form-item{width:500px\n}\n.orderOp .ivu-divider-horizontal.ivu-divider-with-text-left:before{width:1%\n}\n.orderOp .ivu-divider-horizontal.ivu-divider-with-text-left .ivu-divider-inner-text,.orderOp .ivu-divider-horizontal.ivu-divider-with-text-right .ivu-divider-inner-text{font-weight:700\n}\n#orderModal .ivu-collapse .ivu-checkbox-group{display:inline-block\n}\n#orderModal .orderTitle{padding:7px 16px\n}\n#orderModal .dividerBottom{margin-bottom:20px\n}\n#orderModal .judgeBox{padding:0 20px 20px\n}\n#orderModal .judgeRules{padding:6px;line-height:30px\n}\n#orderModal .judgeCheckBox{padding:20px;border:1px solid #f90\n}\n.draButton{display:inline-block\n}\n.calJson,.outputDeploies{width:90%;display:flex;flex-wrap:wrap;min-height:40px;padding:10px 10px 0;border:1px solid #dcdee2;border-radius:4px\n}\n.calJson .no-move,.outputDeploies .no-move{transition:-webkit-transform 0s;transition:transform 0s;transition:transform 0s,-webkit-transform 0s\n}\n.calJson .ghost,.outputDeploies .ghost{opacity:.5;background:#c8ebfb\n}\n.calJson .elementColor0,.calJson .elementColor1,.calJson .elementColor2,.outputDeploies .elementColor0,.outputDeploies .elementColor1,.outputDeploies .elementColor2{background:#ea7e7e\n}\n.calJson .elementColor3,.calJson .elementColor4,.calJson .elementColor5,.outputDeploies .elementColor3,.outputDeploies .elementColor4,.outputDeploies .elementColor5{background:#e3e6de\n}\n.drag-item{padding:4px 18px;color:#000;border:1px solid #ccc;margin-right:10px;margin-bottom:10px;position:relative;cursor:pointer\n}\n.drag-item .ivu-icon{position:absolute;right:0;top:0;color:#fff;cursor:pointer;background:#096\n}\n.w200{width:200px\n}\n.w300{width:300px\n}",""])},5437:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{ref:"calculateForm",attrs:{model:e.calculateForm,"label-width":180,id:"orderOp",rules:e.calculateFormValidate}},[a("FormItem",{attrs:{label:"节点名称",prop:"name"}},[a("Input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:e.calculateForm.name,callback:function(t){e.$set(e.calculateForm,"name",t)},expression:"calculateForm.name"}})],1),a("FormItem",{attrs:{label:"节点类型"}},[a("Input",{staticStyle:{width:"300px"},attrs:{disabled:""},model:{value:e.type1,callback:function(t){e.type1=t},expression:"type1"}})],1),a("FormItem",{attrs:{label:"节点说明",prop:"desc"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},clearable:""},model:{value:e.calculateForm.desc,callback:function(t){e.$set(e.calculateForm,"desc",t)},expression:"calculateForm.desc"}})],1),a("Button",{staticClass:"filterButton",staticStyle:{"margin-left":"180px","margin-bottom":"16px"},attrs:{type:"primary",icon:"md-add"},on:{click:e.modifyNode}},[e._v("新增")]),a("Table",{ref:"table",attrs:{loading:e.loading,height:e.tableHeight,border:"",size:"small",columns:e.columns,data:e.data,"highlight-row":""}}),a("Modal",{attrs:{id:"calculateModal",fullscreen:""},on:{"on-ok":e.calculateSubmit},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-size":"15px"}},[e._v("算术运算设置")])]),a("Form",{ref:"disposesForm",attrs:{model:e.disposesForm,"label-width":180,id:"disposes"}},[a("FormItem",{attrs:{label:"变量名称",prop:"name"}},[a("Cascader",{class:["100"==e.five[0]?"w200":"w300"],staticStyle:{display:"inline-block"},attrs:{data:e.getProcessArray1},model:{value:e.five,callback:function(t){e.five=t},expression:"five"}}),"100"==e.five[0]?a("Input",{staticClass:"inputLeft",staticStyle:{display:"inline-block",width:"100px"},attrs:{disabled:e.disabled1},on:{"on-blur":e.diyNameChange},model:{value:e.diyName,callback:function(t){e.diyName=t},expression:"diyName"}}):e._e()],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:e.disposesForm.desc,callback:function(t){e.$set(e.disposesForm,"desc",t)},expression:"disposesForm.desc"}})],1),a("FormItem",{attrs:{label:"输入数值常量"}},[a("Input",{staticStyle:{width:"300px"},attrs:{clearable:"",maxlength:20},model:{value:e.calculateForm.constant,callback:function(t){e.$set(e.calculateForm,"constant",t)},expression:"calculateForm.constant"}}),a("Icon",{attrs:{type:"ios-checkmark-circle",size:"24",color:"green"},on:{click:function(t){e.itemComfirm("常量","calculateForm")}}}),a("span",{staticStyle:{color:"#999"}},[e._v("限20字符")])],1),a("FormItem",{attrs:{label:"计算项"}},[a("Cascader",{class:["常量"==e.calItem[0]?"w100":"w200"],staticStyle:{display:"inline-block"},attrs:{data:e.getProcessArray,clearable:"",filterable:"",placeholder:"支持输入筛选,可以为空"},on:{"on-change":function(t){e.changeCalItem(t)}},model:{value:e.calculateForm.calItem,callback:function(t){e.$set(e.calculateForm,"calItem",t)},expression:"calculateForm.calItem"}}),"常量"==e.calItem[0]?a("Input",{staticClass:"inputLeft",staticStyle:{display:"inline-block",width:"100px"},model:{value:e.leftConstant,callback:function(t){e.leftConstant=t},expression:"leftConstant"}}):e._e(),a("Icon",{attrs:{type:"ios-checkmark-circle",size:"24",color:"green"},on:{click:function(t){e.itemComfirm("计算项","calculateForm")}}})],1),a("FormItem",{attrs:{label:"计算符号"}},e._l(e.colorArray,function(t,s){return s<=6?a("div",{key:s+10,staticClass:"draButton drag-item",style:{color:"black",background:t.color},attrs:{draggable:"true"},on:{dragstart:function(a){e.dragstart(a,t,s)}}},[a("span",[e._v(e._s(t.name))])]):e._e()})),a("FormItem",{attrs:{label:"公式"}},[a("div",{on:{dragover:function(e){e.preventDefault()},drop:function(t){e.drop(t,"calculateForm")}}},[a("draggable",{staticClass:"list-group calJson",attrs:{element:"div",options:e.dragOptions,move:e.onMove},on:{end:e.dataDragEnd},model:{value:e.disposesForm.arithmetic.calculates,callback:function(t){e.$set(e.disposesForm.arithmetic,"calculates",t)},expression:"disposesForm.arithmetic.calculates"}},e._l(e.disposesForm.arithmetic.calculates,function(t,s){return a("span",{key:s,staticClass:"drag-item",class:"elementColor"+t.type},[e._v("\n               "+e._s(e.labelShow(t))+"\n               "),a("Icon",{attrs:{type:"md-close"},on:{click:function(t){t.stopPropagation(),e.delCard(s,"calculateForm")}}})],1)}))],1)])],1)],1)],1)],1)},o=[],r=(a("7f7f"),a("99d3")),n=a("1516"),i=a.n(n),l={components:{draggable:i.a},data:function(){var e=this;return{newType:!1,modal:!1,loading:!1,type1:"",leftConstant:"",newLabel:[],modifyNodeIndex:0,tableHeight:220,columns:[{title:" ",type:"index",width:50,align:"center"},{title:"处理变量名",key:"nameType",render:function(t,a){var s=e.deepClone(a.row.nameType),o=[];switch(parseInt(s.type)){case 2:s.type="指令节点";break;case 3:s.type="指标节点";break;case 4:s.type="数据处理节点";break;case 5:s.type="循环节点";break;case 6:s.type="判断节点";break;case 7:s.type="报告节点";break;case 8:s.type="触发节点";break;case 9:s.type="系统变量";break;case 10:s.type="常量";break;case 11:s.type="节点属性";break;default:s.type="";break}o.push(""+s.type),s.se&&o.push(""+s.se.name),s.tr&&o.push(""+s.tr.name),s.fo&&o.push(""+s.fo.name),s.fv&&o.push(""+s.fv.name);for(var r=o.length-1;r>=0;r--)if("null"!=o[r]&&null!=o[r]&&void 0!=o[r])return t("div",o[r])}},{title:"标识",key:"label",render:function(e,t){return 0==t.row.label?e("div","新增"):e("div","非新增")}},{title:"类型",key:"disposeType",render:function(e,t){if(1==t.row.disposeType)return e("div","算术运算")}},{title:"数据处理描述",key:"desc"},{title:"操作",key:"action",fixed:"right",width:138,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.modifyNode(a.index,a.row,"修改")}}},"修改"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.deleteNode(a.index,a.row,"删除")}}},"删除")])}}],data:[],five:[],diyName:"",calItem:[],calculateForm:{disposeType:1,calItem:[],disposes:[{arithmetic:{calculates:[]}}]},disposesForm:{arithmetic:{calculates:[]}},calculateFormValidate:{name:[{required:!0,message:"节点名称不能为空",trigger:"blur"},{max:20,message:"最多输入20个字符",trigger:"blur"}]},colorArray:[{color:"#FFDF25",name:"+"},{color:"#FFFF66",name:"-"},{color:"#D0E17D",name:"*"},{color:"#CC9966",name:"/"},{color:"#EF5AA1",name:"("},{color:"#EF5AA1",name:")"},{color:"#EB35A1",name:"MOD"},{color:"#CC6666",name:"变量"},{color:"#36A9CE",name:"常量"}],elementColor:"#47a9da",baseObj:{type:"",se:{},tr:{},fo:{},fv:{}},processArray:[],disabled1:!1,userInfo:JSON.parse(localStorage.getItem("userInfo"))}},created:function(){},computed:{dragOptions:function(){return{animation:0,ghostClass:"ghost"}},getProcessArray:function(){return this.$store.state.yt.processArray},getProcessArray1:function(){var e=this.$store.state.yt.processArray;this.processArray=[];for(var t=0;t<e.length;t++)"数据处理节点"!=e[t].label&&"节点属性"!=e[t].label||this.processArray.push(e[t]);return this.processArray.push({label:"自定义",value:"100"}),this.processArray}},methods:{init:function(e){var t=this;this.getRequest("/operation/NodeDataDispose?id="+e).then(function(e){if(0==e.code){var a=e.content;if(t.type1=Object(r["a"])(e.content),null===a.arithmetic&&(a.arithmetic={calculates:[]}),null===a.nameType&&(a.nameType=t.deepClone(t.baseObj)),t.calculateForm=a,e.content.disposes){t.data=e.content.disposes;for(var s=0;s<e.content.disposes.length;s++)0==parseInt(e.content.disposes[s].label)&&(t.newLabel.push(e.content.disposes[s].nameType.se.name),console.log(t.newLabel))}else t.data=[]}})},getData:function(){var e=this.deepClone(this.calculateForm);return e},itemComfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"计算项",t=arguments.length>1?arguments[1]:void 0;this.deepClone(this.baseObj);if("calculateForm"==t){var a=this.deepClone(this.baseObj),s=this.calculateForm.calItem;if("计算项"==e)if("常量"==s[0]){var o=this.deepClone(s);o.push(this.leftConstant),a=Object(r["c"])(o)}else a=Object(r["c"])(s);else"常量"==e&&(a.type=10,a.se.name=this.calculateForm.constant,a.se.num=1);this.disposesForm.arithmetic.calculates.push(a)}},labelShow:function(e){return e.fv&&"{}"!==JSON.stringify(e.fv)&&e.fv.name?e.fv.name:e.fo&&"{}"!==JSON.stringify(e.fo)&&e.fo.name?e.fo.name:e.tr&&"{}"!==JSON.stringify(e.tr)&&e.tr.name?e.tr.name:e.se&&"{}"!==JSON.stringify(e.se)&&e.se.name?e.se.name:0==e.type?"开始节点":1==e.type?"结束节点":2==e.type?"指令节点":3==e.type?"指标节点":4==e.type?"数据节点":5==e.type?"报告节点":6==e.type?"判断节点":7==e.type?"循环节点":8==e.type?"触发节点":void 0},drop:function(e,t){if(e.dataTransfer.getData("item")){var a=this.deepClone(this.baseObj);a.type="10",a.se.name=e.dataTransfer.getData("item"),a.se.num=0,"calculateForm"==t&&this.disposesForm.arithmetic.calculates.push(a)}},onMove:function(e){e.draggedContext,e.relatedContext;return!0},dragstart:function(e,t,a){e.dataTransfer.setData("item",t.name)},dataDragEnd:function(e){e.preventDefault()},delCard:function(e,t){"calculateForm"==t&&this.disposesForm.arithmetic.calculates.splice(e,1)},modifyNode:function(e,t,a){if(this.calItem=[],this.calculateForm.calItem=[],this.leftConstant="",this.modal=!0,"修改"==a)if(this.modifyNodeIndex=e,this.newType=!1,this.disposesForm=t,0==parseInt(t.label))this.five=[],this.five.push("100"),this.diyName=t.nameType.se.name,this.disabled1=!0;else{var s=this.deepClone(this.disposesForm.nameType),o=[];switch(parseInt(s.type)){case 2:s.type="指令节点";break;case 3:s.type="指标节点";break;case 4:s.type="数据处理节点";break;case 5:s.type="循环节点";break;case 6:s.type="判断节点";break;case 7:s.type="报告节点";break;case 8:s.type="触发节点";break;case 9:s.type="系统变量";break;case 10:s.type="常量";break;case 11:s.type="节点属性";break;default:s.type="";break}if(o.push(""+s.type),s.se&&o.push(""+s.se.name),s.tr&&o.push(""+s.tr.name),s.fo&&o.push(""+s.fo.name),s.fv&&o.push(""+s.fv.name),this.five=o,"数据处理节点"==this.five[0]){for(var r=this.processArray,n=!1,i=0;i<r.length;i++)if(void 0!=r[i].children)for(var l=0;l<r[i].children.length;l++)void 0!=this.five[1]?this.five[1]==r[i].children[l].label&&(n=!0):r[i].children||(n=!0);0==n&&(this.five=[]),this.disabled1=!1}}else this.newType=!0,this.disposesForm={arithmetic:{calculates:[]}},this.calculateForm.constant="",this.five=[],this.disabled1=!1},deleteNode:function(e,t,a){var s=this;this.$Modal.confirm({title:"删除",content:"您确认删除该条数据?",onOk:function(){s.calculateForm.disposes.splice(e,1),s.data=s.calculateForm.disposes,s.$Message.success("删除成功")}})},calculateSubmit:function(){if(100==parseInt(this.five[0])){var e={type:"4",se:{num:0,name:this.diyName},tr:{num:null,name:null},fo:{num:null,name:null},fv:{num:null,name:null}};this.disposesForm.nameType=e,this.disposesForm.label=0}else this.disposesForm.nameType=Object(r["c"])(this.five),this.disposesForm.label=1;this.disposesForm.disposeType=1,0==this.newType?this.calculateForm.disposes[this.modifyNodeIndex]=this.disposesForm:(null==this.calculateForm.disposes&&(this.calculateForm.disposes=[]),this.calculateForm.disposes.push(this.disposesForm));for(var t=!1,a=0;a<this.newLabel.length;a++)this.newLabel[a]==this.diyName&&(t=!0);if(0==t){""!=this.diyName&&this.newLabel.push(this.diyName);for(a=0;a<this.processArray.length;a++)"数据处理节点"==this.processArray[a].label&&void 0!=this.processArray[a].children&&this.processArray[a].children.push({label:this.diyName,value:this.diyName})}this.data=this.calculateForm.disposes,this.disposesForm={arithmetic:{calculates:[]}},this.calculateForm.calItem=[],this.calculateForm.constant="",this.five=[],this.diyName="",this.calItem=[],this.leftConstant=""},diyNameChange:function(){if(this.newLabel.length>0)for(var e=0;e<this.newLabel.length;e++)this.newLabel[e]==this.diyName&&(this.diyName="",this.$Message.warning("已存在该变量，请重新定义！"))},changeCalItem:function(e){this.calItem=e}}},c=l,p=(a("8fc1"),a("2877")),d=Object(p["a"])(c,s,o,!1,null,null,null);d.options.__file="dataDispose.vue";t["default"]=d.exports},"69b9":function(e,t,a){var s=a("3550");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("499e").default;o("ac528acc",s,!0,{sourceMap:!1,shadowMode:!1})},"8fc1":function(e,t,a){"use strict";var s=a("69b9"),o=a.n(s);o.a},"99d3":function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return o}),a.d(t,"c",function(){return r});a("7f7f");var s=function(e){var t;switch(e.type){case 0:t="开始";break;case 1:t="结束";break;case 2:t="指令";break;case 3:t="指标";break;case 4:t="数据";break;case 5:t="报告";break;case 6:t="判断";break;case 7:t="循环";break;case 8:t="触发";break;default:break}return t},o=function(e){var t=e;switch(t.type){case 2:t.type="指令节点";break;case 3:t.type="指标节点";break;case 4:t.type="数据处理节点";break;case 5:t.type="循环节点";break;case 6:t.type="判断节点";break;case 7:t.type="报告节点";break;case 8:t.type="触发节点";break;case 9:t.type="系统变量";break;case 10:t.type="常量";break;case 11:t.type="节点属性";break;default:t.type="";break}var a=[];return a.push(""+t.type),"常量"==t.type?(t.se&&(0==parseInt(t.se.num)?a.push("字符"):1==parseInt(t.se.num)&&a.push("数值"),a.push(""+t.se.name)),a):(t.se&&a.push(""+t.se.name),t.tr&&a.push(""+t.tr.name),t.fo&&a.push(""+t.fo.name),t.fv&&a.push(""+t.fv.name),a)},r=function(e){var t={type:"",se:{},tr:{},fo:{},fv:{}};if(e.length){switch(e[0]){case"指令节点":t.type="2";break;case"指标节点":t.type="3";break;case"数据处理节点":t.type="4";break;case"循环节点":t.type="5";break;case"判断节点":t.type="6";break;case"报告节点":t.type="7";break;case"触发节点":t.type="8";break;case"系统变量":t.type="9";break;case"常量":t.type="10";break;case"节点属性":t.type="11";break;default:t.type=null;break}if("10"==t.type)return e.length>1?(t.se.name=e[1],"字符"==e[1]?(t.se.num="0",t.se.name=e[2]):"数值"==e[1]&&(t.se.num="1",t.se.name=e[2])):t.se=null,t.tr=null,t.fo=null,t.fv=null,t;e.length>1?(t.se.name=e[1],"网元变量"==e[1]||"数值"==e[1]||"开始节点"==e[1]?t.se.num="1":"循环节点"==e[1]?t.se.num="2":t.se.num="0"):t.se=null,e.length>2?(t.tr.name=e[2],"流程运行时间"==e[2]?t.tr.num="1":t.tr.num="0"):t.tr=null,e.length>3?(t.fo.name=e[3],"当前循环变量值"==e[3]?t.fo.num="1":t.fo.num="0"):t.fo=null,e.length>4?(t.fv.name=e[4],t.fv.num="0"):t.fv=null}else t.type=null;return t}}}]);