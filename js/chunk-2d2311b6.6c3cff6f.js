(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2311b6"],{eeaa:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"home-main"},[o("Row",[o("Col",[o("Card",[o("section",{staticClass:"searchArray"},[o("search-filter",{attrs:{filter:t.filterList,apiurl:"routineJob"},on:{getlist:t.getList}}),o("div",{staticClass:"btnArray"},[o("Button",{attrs:{type:"primary",icon:"md-add",id:"addNew"},on:{click:function(e){t.init("新增")}}},[t._v("新增")])],1)],1),o("Row",[o("Table",{ref:"table",attrs:{loading:t.loading,height:t.tableHeight,border:"",size:"small",columns:t.columns,data:t.data,"highlight-row":""},on:{"on-row-dblclick":function(e){t.init("查看",e)}}})],1),o("Row",{staticClass:"tablePage",attrs:{type:"flex",justify:"end"}},[o("Page",{attrs:{current:t.pageNumber,total:t.total,"page-size":t.pageSize,"page-size-opts":[20,50,100],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1)],1)],1),o("Modal",{attrs:{title:t.btnName,width:"900",id:"routineJobModal","footer-hide":""},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[o("routine-job-form",{ref:"routineJobForm",attrs:{id:"routineJobForm"},on:{"on-cancel":t.formHide,"on-add":t.formAdd,"on-show":t.formShow}})],1)],1)},n=[],a=o("be94"),r=(o("78ce"),o("ade3")),s=o("0e23"),l={components:{routineJobForm:s["default"]},data:function(){var t,e=this;return{modal1:!1,filterList:["keyCity","query"],filterData:{},pageNumber:1,pageSize:20,total:0,loading:!1,columns:[{type:"index",width:60,align:"center"},{title:"任务名称",width:250,key:"routineJobName",sortable:!0},{title:"执行周期",width:100,key:"executePeriod"},{title:"任务状态",width:160,key:"jobStatus",render:function(t,e){return"开启"===e.row.jobStatus?t("div",[t("Tag",{props:{type:"dot",color:"success"}},e.row.jobStatus)]):"关闭"===e.row.jobStatus?t("div",[t("Tag",{props:{type:"dot",color:"error"}},e.row.jobStatus)]):"草稿"===e.row.jobStatus?t("div",[t("Tag",{props:{type:"dot",color:"info"}},e.row.jobStatus)]):t("div",[t("Tag",{props:{type:"dot",color:"error"}},e.row.jobStatus)])}},{title:"执行时间",width:160,key:"startTime",sortable:!0,render:function(t,o){return t("div",e.formatDate(new Date(o.row.startTime),"yyyy-MM-dd HH:mm:ss"))}},{title:"执行概况",width:550,key:"jobStatus",render:function(t,o){var i="无记录",n="无记录";return o.row.lastTimeResult&&(i=o.row.lastTimeResult),o.row.endTime&&(n=e.formatDate(new Date(o.row.endTime),"yy-MM-dd HH:mm")),t("div",[t("span",{style:{marginRight:"5px",width:"60px",display:"inline-block"}},"总计:"+o.row.total),t("span",{style:{marginRight:"5px",width:"60px",display:"inline-block"}},"成功:"+o.row.success),t("span",{style:{marginRight:"5px",width:"60px",display:"inline-block"}},"失败:"+o.row.failure),t("span",{style:{marginRight:"5px",width:"140px",display:"inline-block"}},"上次:"+n),t("span",{style:{marginRight:"5px",width:"80px",display:"inline-block"}},"结果:"+i),t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.jobResult(o.row)}}},"结果管理")])}},{title:"地市",width:100,key:"operateCity"},{title:"网元类别",width:100,key:"neCategory"},{title:"网元类型",width:100,key:"neType"},{title:"设备厂家",width:100,key:"neProducer"},(t={title:"网元名称",width:160},Object(r["a"])(t,"width",200),Object(r["a"])(t,"key","neNames"),Object(r["a"])(t,"sortable",!0),t),{title:"修改人员",width:100,key:"updater"},{title:"最近修改时间",width:160,key:"updateTime",sortable:!0,render:function(t,o){return t("div",e.formatDate(new Date(o.row.updateTime),"yyyy-MM-dd HH:mm:ss"))}},{title:"创建人员",width:100,key:"creater"},{title:"创建时间",width:160,key:"createTime",sortable:!0,render:function(t,o){return t("div",e.formatDate(new Date(o.row.createTime),"yyyy-MM-dd HH:mm:ss"))}},{title:"描述信息",width:250,key:"remark"},{title:"操作",key:"action",fixed:"right",width:300,align:"center",render:function(t,o){var i="开启";return"开启"===o.row.jobStatus?i="关闭":"关闭"!==o.row.jobStatus&&"草稿"!==o.row.jobStatus||(i="开启"),t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.init("查看",o.row)}}},"查看"),t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.init("修改",o.row)}}},"修改"),t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.swicth(o.row)}}},i),t("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.stop(o.row)}}},"停用"),t("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.del(o.row)}}},"删除")])}}],tableHeight:450,data:[],userInfo:JSON.parse(localStorage.getItem("userInfo")),maxLength:20,btnName:"",startTime:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}}}},methods:{getList:function(t){var e=this;this.loading=!0,t&&(this.filterData=t);var o=Object(a["a"])({},this.filterData,{pageNumber:this.pageNumber,pageSize:this.pageSize});this.getRequest("/routinejob/routineJob",o).then(function(t){e.data=t.content.list,e.total=t.content.total,e.loading=!1})},changePage:function(t){this.pageNumber=t,this.$refs.table.selectAll(!1),this.getList()},changePageSize:function(t){this.pageSize=t,this.getList()},rowClassName:function(t,e){if("失败"==t.result)return"abnormal"},jobResult:function(t){this.$store.commit("jobResultEvent",t.routineJobName),this.$router.push({name:"jobResult"})},del:function(t){var e=this;this.$Modal.confirm({title:"删除",content:"您确认删除该条数据?",onOk:function(){e.deleteRequest("/routinejob/routineJob?id="+t.routineJobId+"&deleter="+e.userInfo.username).then(function(t){0==t.code?(e.$Message.success("删除成功"),e.getList()):2==t.code&&e.$Message.info({content:t.result,duration:10,closable:!0})})}})},swicth:function(t){var e=this,o="",i="";"开启"===t.jobStatus?(o="close",i="关闭"):"关闭"!==t.jobStatus&&"草稿"!==t.jobStatus||(o="start",i="开启"),this.$Modal.confirm({title:i,content:"您确认"+i+"该条数据?",onOk:function(){e.putYTRequest("/routinejob/routineJob/"+o+"?id="+t.routineJobId+"&closer="+e.userInfo.username+"&updater="+e.userInfo.username).then(function(o){e.$Message.info({content:o.result,duration:10,closable:!0}),0==o.code&&(t.jobStatus=i)})}})},stop:function(t){var e=this;"草稿"===t.jobStatus?this.$Message.info({content:'你选择的任务已经是<span style="color:#f90"> '+t.jobStatus+" </span>态,无需重复操作",duration:10,closable:!0}):this.$Modal.confirm({title:"停用",content:"您确认停用该条数据?",onOk:function(){e.putYTRequest("/routinejob/routineJob/stop?id="+t.routineJobId+"&stoper="+e.userInfo.username).then(function(o){e.$Message.info({content:o.result,duration:10,closable:!0}),0==o.code&&(t.jobStatus="草稿")})}})},init:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getThreeAndFour(this),this.btnName=t,this.$refs.routineJobForm.init(t,e)},formShow:function(){this.modal1=!0},formHide:function(){this.modal1=!1},formAdd:function(){this.modal1=!1,this.getList()}},created:function(){this.getList()},mounted:function(){this.tableHeight=window.innerHeight-270}},u=l,c=o("2877"),d=Object(c["a"])(u,i,n,!1,null,null,null);d.options.__file="routineJob.vue";e["default"]=d.exports}}]);